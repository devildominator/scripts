#if 0
	shc Version 3.8.7, Generic Script Compiler
	Copyright (c) 1994-2009 Francisco Rosales <frosal@fi.upm.es>

	shc -v -r -T -f ../../gitRecurserPusherRevised.slash 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[0]))
	"\325\377\030\222\267\222\034\373\341\342\164\042\340\257\070\052"
	"\135\010\050\064\126\334\377"
#define      pswd_z	256
#define      pswd	((&data[52]))
	"\220\145\245\241\363\217\220\157\271\333\057\173\262\172\167\230"
	"\203\065\003\217\232\375\225\164\062\354\121\062\362\056\172\346"
	"\053\277\116\037\074\323\111\376\213\051\221\001\355\304\166\235"
	"\015\017\110\145\020\230\015\044\170\155\020\344\234\212\312\307"
	"\112\030\347\207\353\060\206\167\131\027\170\106\334\357\344\352"
	"\376\054\117\017\305\135\064\075\312\105\041\147\320\353\056\033"
	"\004\026\242\360\107\050\147\240\100\340\347\035\317\313\007\316"
	"\370\127\335\275\264\022\372\177\127\033\346\050\007\025\103\013"
	"\053\345\374\162\016\144\023\117\104\373\154\023\307\164\341\277"
	"\314\277\174\200\321\166\000\051\222\347\121\231\374\225\245\050"
	"\173\242\233\211\006\257\331\112\252\105\136\161\272\100\060\206"
	"\000\254\007\322\043\007\374\265\357\115\117\353\343\364\024\136"
	"\226\257\350\235\137\301\347\011\006\106\173\301\207\253\107\207"
	"\130\117\131\174\126\126\061\106\243\201\062\207\165\106\345\014"
	"\366\315\251\125\216\221\137\225\330\332\126\137\206\236\346\336"
	"\355\100\133\104\226\215\212\072\016\275\301\204\003\247\220\372"
	"\164\071\120\003\313\257\230\243\212\357\002\020\216\351\357\173"
	"\052\112\300\301\327\113\374\346\010\276\152\014\145\307\325\203"
	"\054\173\044\037\012\264\216\304\217\276\100\102\071\267\333\274"
	"\355\337\113\210\334\341\374\017\316\116\102\301\025\027\104\101"
	"\223\151\141\236\035\357"
#define      xecc_z	15
#define      xecc	((&data[351]))
	"\243\360\217\367\234\343\135\105\152\002\142\305\112\036\101\101"
	"\307\347\132"
#define      opts_z	1
#define      opts	((&data[368]))
	"\357"
#define      rlax_z	1
#define      rlax	((&data[369]))
	"\063"
#define      chk1_z	22
#define      chk1	((&data[374]))
	"\230\236\032\332\221\341\014\157\352\072\040\056\054\063\225\305"
	"\015\257\024\266\026\033\356\077\101\202\137\060\361\244"
#define      lsto_z	1
#define      lsto	((&data[400]))
	"\111"
#define      text_z	3009
#define      text	((&data[505]))
	"\302\206\331\160\051\312\127\204\226\372\314\102\352\234\312\272"
	"\151\142\131\203\075\271\264\056\135\045\264\153\370\327\226\273"
	"\136\160\053\207\072\203\013\320\176\330\022\150\164\335\043\335"
	"\100\174\141\175\066\025\254\224\073\140\377\064\070\226\360\226"
	"\006\033\036\100\237\051\021\035\002\044\206\166\001\251\124\102"
	"\046\266\300\135\314\154\361\010\315\361\074\006\207\054\234\216"
	"\110\272\317\350\344\340\006\347\100\165\277\210\155\364\016\354"
	"\212\340\351\312\353\233\203\327\020\070\135\004\021\243\160\057"
	"\227\006\010\321\352\045\002\200\341\153\367\064\210\276\014\335"
	"\375\272\270\370\077\207\334\375\263\227\365\270\372\157\360\237"
	"\030\334\066\005\247\151\345\224\071\107\363\146\207\115\014\271"
	"\215\252\135\266\077\013\005\261\224\075\360\307\226\205\051\242"
	"\211\275\011\060\362\304\210\167\131\003\347\152\226\301\020\103"
	"\036\064\346\004\354\211\344\020\110\063\225\041\150\314\001\333"
	"\312\024\262\311\174\065\206\213\041\007\150\302\363\137\030\074"
	"\206\173\224\214\147\030\121\235\333\230\311\124\340\341\015\041"
	"\062\107\015\101\162\234\365\276\252\233\152\025\055\366\123\250"
	"\011\262\310\060\156\316\370\103\321\006\142\206\042\144\225\324"
	"\026\036\016\047\101\254\212\063\300\020\171\063\130\030\132\035"
	"\055\040\141\207\335\072\202\062\262\273\011\230\032\153\011\345"
	"\075\241\176\242\032\001\242\162\064\060\363\023\133\065\277\142"
	"\373\155\023\053\226\246\005\065\262\242\333\277\304\032\202\127"
	"\375\322\124\212\307\013\023\174\244\075\327\233\371\053\276\374"
	"\053\123\372\110\366\147\047\071\071\057\162\354\153\312\127\003"
	"\052\235\356\307\235\017\171\317\162\115\243\210\015\106\311\215"
	"\376\376\113\362\075\132\155\013\347\336\335\271\113\063\123\314"
	"\331\015\326\106\021\265\125\241\166\121\317\170\312\241\140\230"
	"\140\104\011\000\325\351\261\362\251\066\233\376\117\125\153\314"
	"\045\371\365\010\105\236\063\174\270\205\322\117\315\320\240\303"
	"\366\200\015\321\234\123\367\355\115\373\134\120\110\370\131\301"
	"\072\056\273\214\312\107\051\356\321\113\064\014\061\174\351\251"
	"\344\145\311\275\264\073\146\147\154\032\177\351\360\207\143\040"
	"\247\230\374\327\345\043\244\377\071\030\272\270\337\277\231\020"
	"\265\026\272\207\113\120\243\204\356\067\275\155\153\023\260\352"
	"\206\103\152\033\342\120\255\042\335\326\227\221\075\121\354\221"
	"\372\121\062\002\176\253\275\302\014\012\035\374\035\252\205\105"
	"\370\316\340\366\116\136\300\217\352\376\310\231\237\220\206\113"
	"\101\320\272\212\160\253\362\021\202\213\202\347\202\051\252\053"
	"\171\025\122\343\052\104\026\207\333\323\176\250\331\167\352\233"
	"\151\376\065\036\317\045\051\152\303\203\135\231\116\261\212\166"
	"\001\117\371\044\075\104\107\074\305\162\245\054\041\154\363\324"
	"\157\160\012\270\035\264\107\002\230\245\177\315\162\060\062\274"
	"\152\342\066\176\340\007\375\025\217\070\052\332\260\100\163\354"
	"\137\326\001\132\372\252\225\242\205\364\164\310\064\256\035\350"
	"\037\332\150\141\062\343\254\006\045\312\203\333\246\226\150\064"
	"\372\245\036\254\335\373\211\174\106\030\271\257\037\037\325\111"
	"\370\073\223\172\063\210\357\113\217\031\025\036\231\220\015\272"
	"\334\142\044\161\021\316\354\364\320\312\330\131\076\276\275\027"
	"\042\061\133\012\234\124\135\200\175\257\033\143\255\074\033\344"
	"\032\111\267\025\045\311\026\165\265\056\372\157\154\134\354\020"
	"\110\110\161\351\027\370\270\343\272\200\027\200\177\107\270\005"
	"\074\134\257\040\231\031\156\026\307\066\232\362\307\332\075\103"
	"\266\031\124\202\003\341\370\010\310\313\124\040\333\117\326\205"
	"\212\055\055\303\222\121\256\002\204\354\003\272\376\111\155\111"
	"\035\306\276\226\161\262\202\261\235\135\000\032\362\262\033\377"
	"\221\152\244\310\350\305\325\350\322\272\112\140\252\146\311\213"
	"\345\363\032\074\020\124\262\146\351\033\220\315\104\360\041\133"
	"\163\005\040\333\020\111\341\067\047\173\220\030\233\316\175\326"
	"\317\016\367\065\275\141\113\357\321\363\063\317\057\014\235\036"
	"\267\021\151\031\330\370\054\000\243\244\372\126\363\330\033\037"
	"\365\324\313\224\104\355\006\170\021\244\072\066\151\241\245\232"
	"\314\113\325\351\347\211\361\241\165\243\271\145\016\250\054\004"
	"\305\123\303\170\265\317\075\313\013\064\377\137\130\136\226\305"
	"\241\010\354\132\030\034\031\061\032\032\253\350\325\274\202\046"
	"\325\256\223\255\251\001\374\214\070\332\234\022\010\361\314\277"
	"\337\025\062\341\032\342\300\165\304\271\047\312\161\272\155\356"
	"\043\335\364\176\317\142\055\024\216\217\120\127\020\307\200\273"
	"\034\331\245\252\040\314\037\356\351\353\272\300\214\142\226\327"
	"\062\322\311\344\316\244\012\024\127\372\006\351\006\221\176\301"
	"\313\022\145\045\301\214\015\064\257\335\170\246\354\217\060\074"
	"\363\023\226\310\330\323\036\224\351\211\367\226\200\173\203\236"
	"\211\071\245\236\215\361\111\166\322\150\366\065\200\121\245\362"
	"\031\127\214\220\221\322\317\063\052\046\325\331\325\160\233\050"
	"\116\135\305\300\321\261\076\323\327\111\201\151\361\147\267\352"
	"\337\361\213\345\254\266\307\167\070\351\006\005\331\135\345\372"
	"\132\114\024\237\046\052\250\271\034\255\234\125\235\210\017\274"
	"\051\273\174\372\172\273\023\032\377\101\164\037\246\103\044\011"
	"\044\265\007\077\361\124\372\374\244\243\120\244\256\370\323\320"
	"\266\056\300\162\365\071\371\132\304\145\070\336\147\371\241\223"
	"\335\002\220\074\162\161\250\273\010\142\361\120\231\265\306\307"
	"\325\037\362\241\335\053\325\204\306\052\121\374\035\362\207\153"
	"\151\237\255\245\277\043\173\212\201\227\071\361\077\065\027\333"
	"\063\222\014\227\127\121\362\026\215\152\146\072\224\106\271\207"
	"\013\124\234\352\103\206\030\235\242\315\105\256\024\167\010\301"
	"\100\275\376\256\020\047\110\027\306\247\007\117\025\200\313\042"
	"\070\014\006\273\131\105\176\052\362\372\037\151\221\360\034\324"
	"\255\157\177\235\010\234\353\371\370\172\002\112\165\157\174\324"
	"\121\134\160\351\075\317\310\310\247\115\243\006\010\113\162\015"
	"\320\374\252\231\150\357\336\374\320\120\037\077\236\034\113\314"
	"\270\247\113\037\051\321\317\237\047\203\113\050\347\050\033\175"
	"\254\040\362\072\203\247\261\205\132\352\342\052\012\003\373\246"
	"\207\033\234\001\116\322\257\354\371\304\235\372\310\051\371\237"
	"\107\365\271\112\217\357\133\022\355\171\317\105\115\271\131\225"
	"\343\100\315\026\160\044\177\126\235\207\155\225\144\267\053\031"
	"\371\257\132\155\001\101\015\123\322\042\122\356\336\067\216\343"
	"\247\154\133\300\123\125\047\144\323\222\243\106\375\347\073\224"
	"\374\152\166\071\176\063\200\020\221\214\337\304\207\242\201\242"
	"\375\322\025\167\122\223\306\315\267\215\033\331\316\123\152\114"
	"\066\070\007\175\207\376\156\332\210\025\136\366\020\357\024\050"
	"\025\240\124\177\152\113\336\002\371\024\340\176\147\263\257\050"
	"\347\255\175\157\122\123\255\277\114\361\305\225\027\006\303\024"
	"\075\023\244\201\251\371\274\263\133\145\173\353\255\222\041\263"
	"\027\001\073\023\365\211\306\015\240\024\335\111\174\312\102\370"
	"\136\045\332\075\232\012\207\144\050\261\330\244\357\265\344\214"
	"\235\031\222\150\036\274\043\317\202\301\350\022\361\260\255\240"
	"\201\112\162\240\251\264\043\246\160\003\156\135\234\241\147\074"
	"\032\136\041\066\364\046\255\045\276\065\073\005\315\304\251\354"
	"\100\141\116\230\276\224\226\321\315\072\121\257\207\334\166\253"
	"\242\026\235\016\141\071\137\033\327\010\331\210\016\130\377\264"
	"\313\172\046\364\314\172\213\005\204\264\060\131\320\151\062\015"
	"\102\140\275\206\270\142\067\027\202\011\105\262\264\064\037\221"
	"\350\225\221\107\173\005\310\073\201\111\072\241\343\251\373\044"
	"\152\300\171\063\254\271\022\011\146\241\147\351\143\241\022\307"
	"\002\225\154\244\013\361\122\352\026\133\227\060\141\262\240\036"
	"\317\037\051\051\302\027\055\153\123\112\212\166\246\216\116\042"
	"\341\023\320\317\127\164\046\003\126\155\060\025\351\267\272\272"
	"\064\204\352\330\157\254\121\077\367\155\115\375\342\336\273\031"
	"\151\247\056\037\135\336\312\134\320\171\242\045\222\374\351\003"
	"\137\011\364\043\226\122\132\046\260\331\315\134\045\316\321\063"
	"\216\362\312\022\003\013\312\020\214\157\220\037\133\012\173\324"
	"\324\231\074\210\325\046\244\207\143\073\356\373\201\112\045\232"
	"\364\034\035\111\163\325\037\167\130\226\037\242\223\143\034\366"
	"\234\371\313\300\043\102\107\145\110\055\073\141\354\101\235\127"
	"\230\134\370\343\033\033\126\034\124\165\354\030\266\330\214\322"
	"\077\066\151\330\273\230\234\017\031\312\204\174\236\030\265\366"
	"\013\243\114\047\333\333\066\036\055\303\025\250\314\274\311\234"
	"\141\257\046\211\171\143\256\206\022\276\055\342\333\267\206\374"
	"\211\251\370\214\137\227\245\215\323\051\341\323\373\253\204\334"
	"\266\121\161\341\042\374\210\375\032\230\372\025\073\177\050\134"
	"\262\242\237\263\072\021\252\051\310\332\225\336\260\101\116\241"
	"\326\154\157\237\277\171\072\163\214\176\131\346\034\276\122\061"
	"\162\212\111\257\335\265\131\055\210\361\011\020\216\234\220\117"
	"\210\251\136\053\241\231\274\222\255\060\332\360\261\061\154\201"
	"\237\232\263\226\100\313\217\211\201\300\232\030\150\125\212\022"
	"\335\026\053\046\032\057\240\010\166\155\232\377\234\034\046\140"
	"\145\274\051\262\255\153\144\143\153\304\000\031\364\060\022\306"
	"\133\355\331\104\155\113\014\161\255\222\333\044\371\202\307\047"
	"\107\061\372\031\244\017\311\067\313\147\375\123\125\354\355\103"
	"\110\326\250\321\004\006\103\073\120\140\030\220\227\170\231\216"
	"\006\331\175\046\075\224\135\042\356\123\374\375\151\003\272\113"
	"\343\122\003\125\252\277\306\224\004\150\177\357\006\335\045\006"
	"\303\141\020\302\060\244\104\235\327\245\247\376\227\216\145\246"
	"\341\052\236\376\173\176\160\076\265\110\231\252\227\225\165\316"
	"\315\366\110\206\014\004\175\160\047\173\223\102\103\331\061\357"
	"\030\116\332\105\036\032\064\055\211\247\120\354\043\142\200\061"
	"\267\220\163\222\016\203\333\362\156\166\036\003\127\025\312\136"
	"\131\373\134\347\355\273\100\101\363\105\310\053\264\376\000\027"
	"\176\135\064\347\067\246\104\171\006\145\055\357\143\130\236\367"
	"\266\270\251\325\275\056\015\201\076\012\041\303\342\207\355\066"
	"\055\066\135\062\337\201\062\225\246\116\336\376\354\344\234\256"
	"\204\373\054\000\031\301\077\147\022\222\171\315\317\257\172\044"
	"\327\273\267\167\124\105\372\165\231\327\312\052\005\367\221\030"
	"\013\042\360\120\014\041\072\033\217\304\356\161\335\130\240\222"
	"\263\133\145\206\253\017\174\301\114\022\332\260\271\273\151\107"
	"\327\340\160\376\236\244\152\001\170\315\336\310\047\300\055\310"
	"\141\101\272\000\333\117\140\033\155\217\373\315\351\310\253\075"
	"\145\263\127\222\201\176\303\157\214\100\136\127\326\162\322\241"
	"\154\043\361\367\053\212\063\246\313\155\042\107\317\321\226\170"
	"\165\100\233\174\365\106\161\347\213\111\351\064\376\266\147\325"
	"\102\251\054\163\324\040\362\255\255\046\250\376\341\352\350\101"
	"\136\365\074\250\041\017\016\174\250\234\300\141\106\221\023\072"
	"\055\022\025\005\252\232\260\246\314\116\212\332\126\150\026\266"
	"\262\370\041\106\212\302\065\237\346\271\313\253\010\304\266\172"
	"\203\153\354\005\066\347\212\000\057\300\334\132\010\266\130\023"
	"\221\356\261\014\366\352\301\005\240\251\265\317\014\075\362\356"
	"\202\267\034\001\065\203\034\013\323\362\232\334\221\033\333\223"
	"\121\000\111\122\050\067\212\361\345\252\301\311\300\324\041\335"
	"\033\344\364\166\333\232\312\026\374\272\116\357\201\204\302\325"
	"\014\030\365\260\347\317\043\346\320\102\264\316\357\012\326\330"
	"\245\022\030\001\253\103\275\077\130\232\344\302\134\334\316\350"
	"\315\115\377\320\374\050\370\105\025\055\277\243\120\166\227\060"
	"\234\166\343\054\167\254\322\117\275\367\227\217\027\007\134\132"
	"\123\274\216\325\152\376\072\052\163\252\271\217\016\047\246\356"
	"\150\137\274\224\024\040\000\165\234\166\145\326\032\021\307\206"
	"\044\276\264\002\246\176\320\273\251\062\171\071\214\146\374\300"
	"\307\243\032\334\260\353\225\327\233\045\331\164\101\315\331\376"
	"\243\346\114\005\065\202\341\211\303\104\371\343\024\236\024\300"
	"\224\312\074\246\205\040\021\374\161\367\352\311\272\261\062\040"
	"\140\136\111\022\277\106\034\026\070\025\221\235\377\216\172\107"
	"\016\356\137\042\152\147\361\057\002\200\134\324\373\110\265\144"
	"\344\300\343\214\154\130\102\132\266\357\272\353\005\207\116\136"
	"\216\366\204\234\260\271\257\136\061\244\077\173\214\176\340\211"
	"\137\247\177\375\342\007\240\277\031\341\165\215\214\040\372\244"
	"\251\250\216\270\057\320\363\064\140\223\156\353\242\340\330\314"
	"\027\224\216\070\053\025\225\075\051\164\065\376\235\251\216\274"
	"\164\106\253\217\014\023\137\216\320\125\351\041\167\011\323\013"
	"\205\103\064\151\121\164\335\256\146\254\344\144\355\060\242\366"
	"\143\134\047\006\034\161\357\241\225\344\175\014\053\255\247\156"
	"\252\244\121\227\247\347\320\250\362\372\304\337\240\141\274\132"
	"\216\154\165\062\031\210\222\326\130\207\056\064\346\155\336\341"
	"\001\372\251\353\175\111\306\167\207\275\372\113\373\134\265\024"
	"\324\025\044\101\261\071\351\026\151\001\234\135\276\066\230\345"
	"\314\213\137\104\232\360\135\274\177\027\060\216\363\101\106\363"
	"\155\274\126\216\270\160\072\053\276\065\077\077\001\011\212\220"
	"\112\145\045\223\047\135\127\125\011\004\214\135\006\065\262\110"
	"\134\150\011\271\065\166\253\075\103\234\172\112\044\247\346\262"
	"\360\241\201\330\206\142\336\155\146\153\313\155\241\176\266\375"
	"\347\277\267\034\065\142\131\171\376\323\303\042\172\252\325\153"
	"\113\127\103\322\271\042\077\040\215\013\215\056\211\103\053\160"
	"\002\342\214\070\105\345\261\103\271\164\146\064\036\073\237\151"
	"\223\343\074\114\005\173\155\222\206\373\300\020\076\354\200\101"
	"\317\014\171\024\362\052\127\254\236\276\341\275\371\200\047\215"
	"\144\143\331\151\337\107\374\146"
#define      shll_z	10
#define      shll	((&data[3643]))
	"\201\251\151\163\111\347\352\037\362\252\142\121\366"
#define      tst2_z	19
#define      tst2	((&data[3656]))
	"\074\215\372\207\135\304\351\247\252\147\214\345\247\011\274\306"
	"\174\037\247\217\354"
#define      msg1_z	42
#define      msg1	((&data[3679]))
	"\242\006\243\203\257\325\153\061\156\213\073\353\351\256\166\272"
	"\354\355\267\344\276\012\224\025\225\021\130\225\154\113\002\312"
	"\346\030\162\247\061\070\166\033\250\347\056\346\320\337\303\235"
	"\004\352\052\150\115\004\321"
#define      date_z	1
#define      date	((&data[3730]))
	"\342"
#define      msg2_z	19
#define      msg2	((&data[3733]))
	"\011\016\004\044\326\073\205\144\267\255\224\267\057\247\262\276"
	"\235\140\334\224\276\064\000"
#define      inlo_z	3
#define      inlo	((&data[3754]))
	"\113\026\247"
#define      tst1_z	22
#define      tst1	((&data[3758]))
	"\165\322\225\242\127\152\246\015\300\347\016\373\024\101\163\076"
	"\360\057\203\101\116\135\246\037\233\173\303\037"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
